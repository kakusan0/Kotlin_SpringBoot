<!DOCTYPE html>
<!-- 共通 head フラグメント: 各ページの head 部分をここで管理 -->

<head th:fragment="commonHead(title)">
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <meta charset="UTF-8"/>
    <!-- SEO: ページごとの説明を設定可能。コントローラで model.addAttribute("description", "...") を渡すと上書きされます -->
    <meta name="description"
          th:attr="content=${description != null ? description : 'シンプルな管理用ダッシュボード。ツールの選択とコンテンツ表示を提供します。'}"/>

    <!-- CSRF Token for AJAX requests -->
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <!-- Favicon -->
    <link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon"/>
    <link rel="icon" th:href="@{/favicon.svg}" type="image/svg+xml"/>

    <!-- Critical CSS moved to /css/style.css for maintainability and caching -->

    <!-- Stylesheets: preload を使って非同期にロード（onload で stylesheet に切り替え） -->
    <link as="style" onload="this.onload=null;this.rel='stylesheet'" rel="preload"
          th:href="@{/webjars/bootstrap/5.3.8/css/bootstrap.min.css}">
    <link as="style" onload="this.onload=null;this.rel='stylesheet'" rel="preload"
          th:href="@{/webjars/bootstrap-icons/1.13.1/font/bootstrap-icons.min.css}">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <noscript>
        <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.8/css/bootstrap.min.css}"/>
        <link rel="stylesheet" th:href="@{/webjars/bootstrap-icons/1.13.1/font/bootstrap-icons.min.css}"/>
        <link rel="stylesheet" th:href="@{/css/style.css}"/>
    </noscript>

    <!-- Preload important icon font to avoid blocking font fetch later -->
    <script defer th:src="@{/webjars/bootstrap/5.3.8/js/bootstrap.bundle.min.js}"></script>
    <script defer th:src="@{/js/pwgen.js}"></script>
    <script defer th:src="@{/js/main.js}"></script>
    <!-- pageshow (bfcache 復帰時のリロード) は外部スクリプト /js/main.js に移しました -->

    <title th:text="${title}">アプリケーション</title>
</head>