spring:
  config:
    activate:
      on-profile: war
  cloud:
    vault:
      enabled: ${VAULT_ENABLED:true}
  # Vaultから取得する値（環境変数でオーバーライド可能）
  # Vaultパス: secret/application/war に以下のキーを設定
  #   - db.url, db.username, db.password
  #   - redis.host, redis.port, redis.password
  datasource:
    url: ${db.url:${APP_DB_URL:jdbc:postgresql://db-host:5432/demo_db}}
    username: ${db.username:${APP_DB_USER:demo_user}}
    password: ${db.password:${APP_DB_PASSWORD:demo_pass}}
    hikari:
      maximum-pool-size: ${APP_DB_MAX_POOL:20}
      minimum-idle: ${APP_DB_MIN_IDLE:5}
      connection-timeout: ${APP_DB_CONN_TIMEOUT:30000}
      idle-timeout: ${APP_DB_IDLE_TIMEOUT:600000}
      max-lifetime: ${APP_DB_MAX_LIFETIME:1800000}
  flyway:
    baseline-version: 0
    validate-on-migrate: true
    clean-disabled: true
    out-of-order: false
  session:
    store-type: ${APP_SESSION_STORE:redis}
    redis:
      namespace: ${APP_SESSION_NAMESPACE:app:sessions}
  data:
    redis:
      host: ${redis.host:${APP_REDIS_HOST:redis-host}}
      port: ${redis.port:${APP_REDIS_PORT:6379}}
      password: ${redis.password:}

server:
  servlet:
    context-path: ${APP_CONTEXT_PATH:/demo}
    session:
      cookie:
        secure: true
      timeout: 10m

logging:
  level:
    root: WARN
    com.example.demo: INFO
  file:
    name: ${LOG_DIR:/var/log/app}/application.log
  logback:
    rollingpolicy:
      max-file-size: 10MB
      max-history: 30

app:
  login:
    rate-limit:
      capacity: ${APP_LOGIN_RATE_CAP:5}
      refill-minutes: ${APP_LOGIN_RATE_REFILL:5}
  trust-proxy: true

