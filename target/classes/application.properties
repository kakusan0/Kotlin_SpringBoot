# Application Configuration
spring.application.name=demo

# Database Configuration
# ????????: DB_URL, DB_USERNAME, DB_PASSWORD
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/demo_db}
spring.datasource.username=${DB_USERNAME:demo_user}
spring.datasource.password=${DB_PASSWORD:demo_pass}

# Flyway Configuration
spring.flyway.enabled=false
spring.flyway.baseline-on-migrate=true
spring.flyway.url=${DB_URL:jdbc:postgresql://localhost:5432/demo_db}
spring.flyway.user=${DB_USERNAME:demo_user}
spring.flyway.password=${DB_PASSWORD:demo_pass}

# Session Configuration
spring.session.jdbc.initialize-schema=always

# HTTPS Configuration (Development)
server.port=8443
server.ssl.enabled=true
server.ssl.key-store=classpath:keystore/keystore.p12
server.ssl.key-store-password=changeit
server.ssl.key-store-type=PKCS12
server.ssl.key-alias=springboot

# Security Configuration
# ?????30?
server.servlet.session.timeout=30m
# ?????Cookie???????
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=true
server.servlet.session.cookie.same-site=strict

# MyBatis Configuration
mybatis.mapper-locations=classpath:mapper/*.xml

# --- Performance: HTTP response compression ---
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xml
server.compression.min-response-size=1024

# --- Static resources: content hash versioning & cache ---
spring.web.resources.chain.enabled=true
spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**
spring.web.resources.cache.period=7d

server.http2.enabled=true

# --- Access log (Tomcat) ---
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.directory=logs
server.tomcat.accesslog.prefix=access
server.tomcat.accesslog.suffix=.log
server.tomcat.accesslog.pattern=combined
server.tomcat.accesslog.rotate=true

# --- Actuator Security ---
# ?????????????????
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized

# --- Security Logging ---
# ????????????????
logging.level.org.springframework.security=INFO
logging.level.com.example.demo.config.SecurityAuditFilter=INFO

# --- Error Handling ---
# ??????????????????
server.error.include-stacktrace=never
server.error.include-message=never
server.error.include-binding-errors=never

# --- Additional Security Settings ---
# ????????????????DoS?????
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Server connection timeout
server.tomcat.connection-timeout=20s
